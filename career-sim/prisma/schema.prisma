datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  user_id          BigInt   @id @default(dbgenerated("AUTO_RANDOM"))
  email            String   @unique
  name             String?
  country          String?
  created_at       DateTime @default(now())
  skills           UserSkill[]
  userProfile      UserProfile?

  @@map("users")
}

model UserSkill {
  user_id     BigInt
  skill_name  String // main thing thats used
  last_updated  DateTime? @db.Date

  user User @relation(fields: [user_id], references: [user_id], onDelete: Cascade)

  @@id([user_id, skill_name])
  @@index([skill_name])
  @@map("user_skills")
}

model UserProfile {
  user_id          BigInt   @id
  resume           String @db.MediumText
  years_experience Int?     // 0..50
  education        String?
  updated_at       DateTime @updatedAt
  // resume_embedding VECTOR

  user User @relation(fields: [user_id], references: [user_id])
  @@map("user_profile")
}

model Resource {
  resource_id    BigInt   @id @default(autoincrement())
  title          String?
  provider       String?
  url            String?
  hours_estimate Decimal? @db.Decimal(5,1)
  cost           Decimal? @db.Decimal(8,2) @default(0)
  skill_targets  Json?
  description    String? @db.MediumText

  @@index([provider])
  @@map("resources")
}

model SkillNode {
  id         BigInt   @id @default(autoincrement())
  name       String
  parent_id  BigInt?
  aliases    Json?
  // VECTOR embedding  in TiDB;, set via raw SQL
  @@index([parent_id])

  @@map("skill_node")
}



